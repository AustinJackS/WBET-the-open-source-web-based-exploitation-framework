<html>
<body>
<h1>Server Console!</h1>
<h3 id="console"></h3>
<p id="alt"></p>
<input id="inp1"></input>
<input id='cid' value=0></input>
<button id="btn1" onclick="sen()" disabled>Send</button>
<button onclick="consol.innerHTML = '';">clear log</button>
<button onclick="consol = document.getElementById('alt');">small text</button>
<button onclick="consol = document.getElementById('console');">large text</button>
<script>

//definie needed variables
var consol = document.getElementById('console');
var btn1 = document.getElementById('btn1');
var ws = require("nodejs-websocket")
var connections = [];
var i;
window.inc=0;
var server = ws.createServer(function (conn) {
	//define connection number by get value of input field of id  'cid'
	var cnum = document.getElementById('cid').value;
	//push new connections to array
	connections.push(conn);
	//globalize connections variable for onclick function
	window.cnn = connections;
	//write events to console
    consol.innerHTML+=inc + ':' + 'New Connection<br>';
    window.cnn[window.inc].sendText(inc.toString());
    window.inc += 1;
    document.getElementById('btn1').disabled = false;
    for (i=0;i<window.cnn.length;i++) {
    	window.cnn[i].on("text", function (str) {
       		consol.innerHTML += "Received:"+str+'<br>';
    	})
    }
    for (i=0;i<window.cnn.length;i++) {
    	window.cnn[i].on("close", function (code, reason) {
        	consol.innerHTML += "Connection Closed"+'<br>';
    	})
    }
}).listen(8001)
function sen() {
	var cnum = document.getElementById('cid').value;
	var inp = document.getElementById("inp1").value;
    window.cnn[cnum].sendText(inp);
    consol.innerHTML +=  cnum+':'+'Sent:' + inp+'<br>';
}
</script>
<script>
document.getElementById("inp1")
    .addEventListener("keyup", function(event) {
    event.preventDefault();
    if (event.keyCode == 13) {
        document.getElementById("btn1").click();
    }
});
</script>
</body>
</html>